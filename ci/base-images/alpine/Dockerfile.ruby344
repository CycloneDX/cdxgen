FROM ruby:3.4.4-alpine

ENV PATH=${PATH}:/usr/local/bin:/root/.rbenv/bin:/opt/pypi/bin:${PYTHONPATH}:

RUN apk update && apk add --no-cache \
    curl \
    tar \
    bash \
    nodejs \
    npm \
    bzip2 \
    python3 \
    python3-dev \
    py3-pip \
    py3-virtualenv \
    gcc \
    g++ \
    openjdk21 \
    musl-dev \
    make \
    git \
    && npm install -g corepack \
    && /usr/bin/python --version \
    && /usr/bin/python -m pip install --no-cache-dir --upgrade atom-tools --target /opt/pypi \
    && node -v \
    && npm -v \
    && java -version \
    && python3 --version \
    && gem install bundler cocoapods \
    && rm -rf /var/cache/apk/*