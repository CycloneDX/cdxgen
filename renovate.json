{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended",
    ":separateMultipleMajorReleases",
    ":enableVulnerabilityAlerts",
    "customManagers:biomeVersions",
    "customManagers:dockerfileVersions",
    "docker:pinDigests",
    "helpers:pinGitHubActionDigestsToSemver"
  ],
  "labels": ["dependency"],
  "minimumReleaseAge": "3 days",
  "gitIgnoredAuthors": [
    "41898282+github-actions[bot]@users.noreply.github.com"
  ],
  "nuget": {
    "ignorePaths": ["**/test/**"]
  },
  "packageRules": [
    {
      "matchDepTypes": ["engines"],
      "rangeStrategy": "auto"
    },
    {
      "description": "cdxgen images: limit docker image updates to exclude major or minor updates as we explicitly set these versions",
      "matchDatasources": ["docker"],
      "matchFileNames": ["ci/**/*"],
      "matchUpdateTypes": ["major", "minor"],
      "enabled": false
    },
    {
      "description": "cdxgen images: limit sdk updates to non-major updates as we explicitly set these versions",
      "matchDatasources": [
        "golang-version",
        "gradle-version",
        "maven",
        "node-version"
      ],
      "matchFileNames": ["ci/**/*"],
      "matchUpdateTypes": ["major"],
      "enabled": false
    },
    {
      "description": ".versions/nvm can update minor and patch as well",
      "matchManagers": ["custom.regex"],
      "matchFileNames": [".versions/nvm"],
      "matchUpdateTypes": ["major", "minor", "patch"]
    },
    {
      "description": "Limit .versions/* files updates to non-major update types as we explicitly set major versions",
      "matchManagers": ["custom.regex"],
      "matchFileNames": [".versions/*"],
      "matchUpdateTypes": ["major"],
      "enabled": false
    },
    {
      "description": "Pin GitHub Actions digests to major version - for those actions which don't support semver",
      "extends": ["helpers:pinGitHubActionDigests"],
      "matchPackageNames": ["addnab/docker-run-action"],
      "extractVersion": "^(?<version>v?\\d+)$",
      "versioning": "regex:^v?(?<major>\\d+)(\\.(?<minor>\\d+)\\.(?<patch>\\d+))?$"
    },
    {
      "description": "Automerge digest pins for latest tags",
      "matchDatasources": ["docker"],
      "matchUpdateTypes": ["digest"],
      "matchCurrentValue": "latest",
      "automerge": true,
      "automergeType": "branch"
    },
    {
      "description": "Disable digest pins for cyclonedx/cdxgen-ruby-builder",
      "matchDatasources": ["docker"],
      "matchPackageNames": ["ghcr.io/cyclonedx/cdxgen-ruby-builder"],
      "matchUpdateTypes": ["pinDigest"],
      "enabled": false
    },
    {
      "description": "Wait 7 days before updating Node.js versions",
      "matchPackageNames": ["/(?:^|/)node$/"],
      "minimumReleaseAge": "7 days"
    }
  ],
  "customManagers": [
    {
      "description": "Custom manager for devEngines runtime in package.json",
      "customType": "jsonata",
      "fileFormat": "json",
      "managerFilePatterns": ["/^package.json$/"],
      "matchStrings": [
        "devEngines.runtime.{ \"depName\": name, \"currentValue\": version, \"depType\": \"devDependencies\"}",
        "devEngines.packageManager.{ \"depName\": name, \"currentValue\": version, \"depType\": \"packageManager\"}"
      ],
      "datasourceTemplate": "npm"
    },
    {
      "description": "Custom manager to maintain ./versions/* files used within GitHub workflows",
      "customType": "regex",
      "managerFilePatterns": ["/.versions/.*/"],
      "matchStrings": [
        "# renovate: datasource=(?<datasource>[a-zA-Z0-9-._]+?) depName=(?<depName>[^\\s]+?)\\s+(?<currentValue>.+?)(\\s)?$"
      ]
    }
  ]
}
